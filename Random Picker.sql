/* Assume that we have a sample Account Payable (AP) table look like this

vendor_num|doc_dte   |process_dte|ref_num     |absvalue|totalinvamt|taxablevalue|gstvalue|doc_type|clientid|acc_doc_num|fiscal_yr|currency|clring_dte|clring_doc_num|net_pay_amt|disc_amt|disc_perc|
----------|----------|-----------|------------|--------|-----------|------------|--------|--------|--------|-----------|---------|--------|----------|--------------|-----------|--------|---------|
6021709   |2020-06-10| 2018-01-11|INVC9       | $142.62|    $142.62|     $129.65|  $12.97|KD      |1061    |3400711244 |     2019|AUD     |2019-03-11|3100038497    |  $3,027.26|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC99      | $218.42|    $218.42|     $198.56|  $19.86|KD      |1061    |3400719055 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-02-11| 2018-03-11|INVC98      | $167.05|    $167.05|     $151.84|  $15.21|KD      |1061    |3400719373 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC96      |  $91.64|     $91.64|      $83.30|   $8.34|KD      |1061    |3400719547 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC94      |  $92.69|     $92.69|      $84.26|   $8.43|KD      |1061    |3400719218 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC91      | $188.85|    $188.85|     $171.68|  $17.17|KD      |1061    |3400718996 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC88      | $242.36|    $242.36|     $220.32|  $22.04|KD      |1061    |3400718483 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-03-11|INVC87      | $182.46|    $182.46|     $165.88|  $16.58|KD      |1061    |3400719390 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-04-11|INVC92      | $299.33|    $299.33|     $272.12|  $27.21|KD      |1061    |3400721212 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-04-11|INVC86      | $213.46|    $213.46|     $194.06|  $19.40|KD      |1061    |3400722628 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021709   |2018-03-11| 2018-05-11|INVC90      | $188.55|    $188.55|     $171.38|  $17.17|KD      |1061    |3400728717 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
---																																																---
6021809   |2018-03-11| 2018-07-11|INVC93      |  $75.12|     $75.12|      $68.28|   $6.84|KD      |1061    |3400739398 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021809   |2018-03-11| 2019-01-11|INVC95      | $109.51|    $109.51|      $99.56|   $9.95|KD      |1061    |3400771467 |     2019|AUD     |2020-03-11|3100041827    |  $4,227.30|   $0.00|     0.00|
6021809   |2018-07-11| 2019-03-11|RD10481603-1|  $44.11|     $44.11|      $40.10|   $4.01|KV      |1061    |4000005341 |     2019|AUD     |2019-04-11|3100039324    |  $1,708.45|   $0.00|     0.00|
6021809   |2019-01-11| 2019-04-11|RD10483039-1|  $63.08|     $63.08|      $57.34|   $5.74|KV      |1061    |4000005345 |     2019|AUD     |2019-07-11|3100039545    |  $7,192.38|   $0.00|     0.00|
6021809   |2019-03-11| 2019-08-11|RD10483536-1|  $12.12|     $12.12|      $11.02|   $1.10|KV      |1061    |4000005468 |     2019|AUD     |2019-09-11|3100040215    |  $4,044.57|   $0.00|     0.00|
6021809   |2020-05-11| 2020-05-11|INVC796     |  $61.44|     $61.44|      $55.86|   $5.58|KD      |1061    |3400866499 |     2019|AUD     |2019-01-12|3100046272    |  $9,326.16|   $0.00|     0.00|
6021809   |2020-05-11| 2020-05-11|INVC795     | $384.73|    $384.73|     $349.77|  $34.96|KD      |1061    |3400865558 |     2019|AUD     |2019-01-12|3100046272    |  $9,326.16|   $0.00|     0.00|
6021809   |2018-01-12| 2018-01-12|INVC850     |  $68.66|     $68.66|      $62.40|   $6.26|KD      |1061    |3400873954 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021809   |2018-03-12| 2018-03-12|INVC877     | $111.03|    $111.03|     $100.94|  $10.09|KD      |1061    |3400884556 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
---																																																---
6021909   |2018-03-12| 2018-03-12|INVC876     | $412.34|    $412.34|     $374.87|  $37.47|KD      |1061    |3400883758 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC875     | $297.29|    $297.29|     $270.26|  $27.03|KD      |1061    |3400884832 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC873     |  $41.89|     $41.89|      $38.08|   $3.81|KD      |1061    |3400884441 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC871     | $171.20|    $171.20|     $155.64|  $15.56|KD      |1061    |3400884405 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC870     | $130.75|    $130.75|     $118.86|  $11.89|KD      |1061    |3400884789 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC869     | $119.06|    $119.06|     $108.24|  $10.82|KD      |1061    |3400882928 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC868     | $137.44|    $137.44|     $124.94|  $12.50|KD      |1061    |3400883707 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|
6021909   |2018-03-12| 2018-03-12|INVC867     |  $50.20|     $50.20|      $45.64|   $4.56|KD      |1061    |3400883636 |     2019|AUD     |2019-05-12|3100047380    |  $7,779.68|   $0.00|     0.00|

Sample description
	1. KD doc_type refferred to invoice in SAP system.

The Manager wants to randomly pick 5 invoices from 3 vendors, then search in SAP to dertermine category of them. Suppose we didn't have invoice detail, only got invoice hard copy in SAP system. */

-- 1. Extract random data for A|B Testing by combining rand() and row_number() functions

with

	rn as (select acc_doc_num, fiscal_yr, clientid, vendor_num, row_number() over (partition by vendor_num order by random()) as rn
	
	    from public.ap_tf
	    
	    where doc_type = 'KD')
    
select

	vendor_num, acc_doc_num, fiscal_yr, clientid

from rn

where rn <= 5;

/* Result

vendor_num|acc_doc_num|fiscal_yr|clientid|
----------|-----------|---------|--------|
6021709   |3400711244 |     2019|1061    |
6021709   |3400719055 |     2019|1061    |
6021709   |3400719373 |     2019|1061    |
6021709   |3400719547 |     2019|1061    |
6021709   |3400719218 |     2019|1061    |
6021809   |3400739398 |     2019|1061    |
6021809   |3400866499 |     2019|1061    |
6021809   |3400865558 |     2019|1061    |
6021809   |3400873954 |     2019|1061    |
6021809   |3400884556 |     2019|1061    |
6021909   |3400883758 |     2019|1061    |
6021909   |3400884441 |     2019|1061    |
6021909   |3400884789 |     2019|1061    |
6021909   |3400883707 |     2019|1061    |
6021909   |3400883636 |     2019|1061    |

Note: This problem is just to extract smaller version of a table in order to test scripts faster. */